# ðŸŽ‰ TFT é¡¹ç›®å®žçŽ°å®Œæˆæ€»ç»“

## ðŸ“¦ å·²åˆ›å»ºçš„æ–‡ä»¶

### æ ¸å¿ƒä»£ç æ–‡ä»¶

1. **`model/temporal_fusion_transformer.py`** (600+ è¡Œ)
   - TFTæ¨¡åž‹å®Œæ•´å®žçŽ°
   - åŒ…å«æ‰€æœ‰æ ¸å¿ƒç»„ä»¶ï¼šå˜é‡é€‰æ‹©ç½‘ç»œã€GRNã€å¤šå¤´æ³¨æ„åŠ›ç­‰
   - æ”¯æŒé™æ€å˜é‡ã€å·²çŸ¥è¾“å…¥ã€è§‚æµ‹è¾“å…¥
   - åŒ…å«åˆ†ä½æ•°æŸå¤±å‡½æ•°

2. **`model/tft_data_processor.py`** (450+ è¡Œ)
   - æ•°æ®é¢„å¤„ç†æ¨¡å—
   - TFTDataset ç±»ï¼ˆPyTorch Datasetï¼‰
   - TFTDataProcessor ç±»ï¼ˆæ•°æ®å¤„ç†ç®¡ç†ï¼‰
   - æ—¶é—´åºåˆ—ç¼©æ”¾å™¨
   - GPå› å­æ•°æ®å‡†å¤‡å·¥å…·

3. **`tft_main.py`** (650+ è¡Œ)
   - å®Œæ•´çš„è®­ç»ƒä¸»ç¨‹åº
   - TFTTrainer è®­ç»ƒå™¨ç±»
   - è‡ªåŠ¨åŒ–è®­ç»ƒæµç¨‹
   - å¯è§†åŒ–åŠŸèƒ½
   - æ¨¡åž‹ä¿å­˜å’ŒåŠ è½½

4. **`tft_quick_start.py`** (250+ è¡Œ)
   - å¿«é€Ÿå¼€å§‹ç¤ºä¾‹
   - ç®€åŒ–çš„è®­ç»ƒæ¼”ç¤º
   - é€‚åˆåˆå­¦è€…æµ‹è¯•

### é…ç½®å’Œæ–‡æ¡£æ–‡ä»¶

5. **`tft_config.yaml`**
   - è¯¦ç»†çš„é…ç½®æ–‡ä»¶æ¨¡æ¿
   - åŒ…å«æ‰€æœ‰å¯é…ç½®å‚æ•°
   - é™„å¸¦è¯¦ç»†æ³¨é‡Šå’Œè¯´æ˜Ž
   - æä¾›ä¸åŒåœºæ™¯çš„é…ç½®ç¤ºä¾‹

6. **`TFT_README.md`**
   - é¡¹ç›®æ¦‚è§ˆæ–‡æ¡£
   - å¿«é€Ÿå¼€å§‹æŒ‡å—
   - æ ¸å¿ƒä»£ç ç¤ºä¾‹
   - æŠ€æœ¯ç»†èŠ‚è¯´æ˜Ž

7. **`TFT_ä½¿ç”¨è¯´æ˜Ž.md`**
   - è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£
   - é…ç½®å‚æ•°è¯´æ˜Ž
   - æœ€ä½³å®žè·µæŒ‡å—
   - å¸¸è§é—®é¢˜è§£ç­”
   - é«˜çº§ç”¨æ³•ç¤ºä¾‹

8. **`install_pytorch.sh`**
   - PyTorchè‡ªåŠ¨å®‰è£…è„šæœ¬
   - æ™ºèƒ½æ£€æµ‹ç³»ç»Ÿå’ŒCUDAç‰ˆæœ¬
   - ä¸€é”®å®‰è£…åˆé€‚çš„PyTorchç‰ˆæœ¬

### ä¾èµ–æ›´æ–°

9. **`requirements.txt`** (å·²æ›´æ–°)
   - æ·»åŠ äº† PyTorch ç›¸å…³ä¾èµ–
   - torch >= 2.0.0
   - torchvision >= 0.15.0
   - torchaudio >= 2.0.0

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### 1. å®Œæ•´çš„TFTæž¶æž„

```
è¾“å…¥å±‚
  â†“
å˜é‡é€‰æ‹©ç½‘ç»œ (VSN)
  â†“
é™æ€åå˜é‡ç¼–ç 
  â†“
LSTM ç¼–ç å™¨
  â†“
LSTM è§£ç å™¨
  â†“
å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶
  â†“
é—¨æŽ§æ®‹å·®ç½‘ç»œ (GRN)
  â†“
è¾“å‡ºå±‚
```

### 2. ä¸Žä½ çš„é¡¹ç›®å®Œç¾Žé›†æˆ

- âœ… è‡ªåŠ¨è¯†åˆ«å’Œå¤„ç† GP ç”Ÿæˆçš„å› å­
- âœ… å…¼å®¹çŽ°æœ‰çš„æ•°æ®æ ¼å¼
- âœ… æ”¯æŒ CSV å’Œ CSV.GZ æ ¼å¼
- âœ… è‡ªåŠ¨ç”Ÿæˆæ—¶é—´ç‰¹å¾
- âœ… çµæ´»çš„æ•°æ®é¢„å¤„ç†

### 3. è®­ç»ƒåŠŸèƒ½

- âœ… è‡ªåŠ¨æ—©åœ
- âœ… å­¦ä¹ çŽ‡è°ƒåº¦
- âœ… æ¢¯åº¦è£å‰ª
- âœ… æ¨¡åž‹æ£€æŸ¥ç‚¹ä¿å­˜
- âœ… è®­ç»ƒåŽ†å²è®°å½•
- âœ… å®žæ—¶è¿›åº¦æ˜¾ç¤º

### 4. è¯„ä¼°å’Œå¯è§†åŒ–

- âœ… å¤šç§è¯„ä¼°æŒ‡æ ‡ (MSE, MAE, RMSE, MAPE, RÂ²)
- âœ… è®­ç»ƒåŽ†å²æ›²çº¿
- âœ… é¢„æµ‹å¯¹æ¯”å›¾
- âœ… æ³¨æ„åŠ›æƒé‡å¯è§†åŒ–
- âœ… å˜é‡é‡è¦æ€§åˆ†æž

## ðŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥èµ°ï¼‰

### ç¬¬1æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
# è‡ªåŠ¨å®‰è£… PyTorchï¼ˆæŽ¨èï¼‰
bash install_pytorch.sh

# æˆ–æ‰‹åŠ¨å®‰è£…
pip install torch torchvision torchaudio

# å®‰è£…å…¶ä»–ä¾èµ–
pip install -r requirements.txt
```

### ç¬¬2æ­¥ï¼šå‡†å¤‡æ•°æ®

ç¡®ä¿ä½ çš„æ•°æ®åŒ…å«ï¼š
- GPå› å­åˆ—ï¼ˆå¦‚ `gp_0`, `gp_1`, ...ï¼‰
- ç›®æ ‡å˜é‡ï¼ˆå¦‚ `label`ï¼‰

### ç¬¬3æ­¥ï¼šè¿è¡Œè®­ç»ƒ

```bash
# å¿«é€Ÿæµ‹è¯•ï¼ˆæŽ¨èå…ˆè¿è¡Œï¼‰
python tft_quick_start.py

# å®Œæ•´è®­ç»ƒ
python tft_main.py
```

å°±è¿™ä¹ˆç®€å•ï¼ðŸŽ‰

## ðŸ“Š ä½¿ç”¨ç¤ºä¾‹

### æœ€ç®€ç¤ºä¾‹ï¼ˆ10è¡Œä»£ç ï¼‰

```python
from model.temporal_fusion_transformer import TemporalFusionTransformer
from model.tft_data_processor import TFTDataProcessor
import pandas as pd

# 1. åŠ è½½æ•°æ®
df = pd.read_csv('your_data.csv.gz', compression='gzip')

# 2. åˆ›å»ºå¤„ç†å™¨
processor = TFTDataProcessor(target_column='label', 
                             encoder_length=60, 
                             decoder_length=10)

# 3. å‡†å¤‡æ•°æ®
processed_df, config = processor.prepare_data_from_gp_factors(
    df, factor_columns=['gp_0', 'gp_1', 'gp_2'])

train_dataset, val_dataset = processor.create_datasets(processed_df, config)
train_loader, val_loader = processor.create_dataloaders(train_dataset, val_dataset)

# 4. åˆ›å»ºæ¨¡åž‹
model = TemporalFusionTransformer(
    observed_inputs=3, 
    known_regular_inputs=4, 
    hidden_size=128)

# 5. è®­ç»ƒ
from tft_main import TFTTrainer
trainer = TFTTrainer(model, train_loader, val_loader, device='cuda')
history = trainer.train()
```

## ðŸŽ¯ æŽ¨èé…ç½®

### å¿«é€ŸåŽŸåž‹ï¼ˆæµ‹è¯•ç”¨ï¼‰

```yaml
model:
  hidden_size: 64
  lstm_layers: 1
  encoder_length: 30
  decoder_length: 5

training:
  batch_size: 128
  max_epochs: 20
```

### ç”Ÿäº§çŽ¯å¢ƒï¼ˆè¿½æ±‚ç²¾åº¦ï¼‰

```yaml
model:
  hidden_size: 256
  lstm_layers: 3
  encoder_length: 120
  decoder_length: 20

training:
  batch_size: 32
  max_epochs: 200
  patience: 20
```

### èµ„æºå—é™ï¼ˆæ˜¾å­˜/å†…å­˜ä¸è¶³ï¼‰

```yaml
model:
  hidden_size: 64
  lstm_layers: 1

training:
  batch_size: 16
  gradient_accumulation_steps: 4
  
data:
  stride_train: 2
```

## ðŸ“ˆ é¢„æœŸæ•ˆæžœ

åŸºäºŽåŠ å¯†è´§å¸æ•°æ®çš„å…¸åž‹è¡¨çŽ°ï¼š

| æŒ‡æ ‡ | å¥½ | ä¸€èˆ¬ | éœ€æ”¹è¿› |
|------|-----|------|--------|
| RÂ² | > 0.3 | 0.1-0.3 | < 0.1 |
| MAPE | < 5% | 5-10% | > 10% |
| æ–¹å‘å‡†ç¡®çŽ‡ | > 55% | 50-55% | < 50% |

## ðŸ’¡ å…³é”®ä¼˜åŠ¿

### vs ä¼ ç»ŸLSTM

- âœ… **æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›**: æ³¨æ„åŠ›æœºåˆ¶æ•æ‰é•¿æœŸä¾èµ–
- âœ… **è‡ªåŠ¨ç‰¹å¾é€‰æ‹©**: å˜é‡é€‰æ‹©ç½‘ç»œè¯†åˆ«é‡è¦ç‰¹å¾
- âœ… **æ›´å¥½çš„å¯è§£é‡Šæ€§**: æ³¨æ„åŠ›æƒé‡å’Œå˜é‡é‡è¦æ€§
- âœ… **å¤šè§†é‡Žé¢„æµ‹**: åŽŸç”Ÿæ”¯æŒé¢„æµ‹å¤šä¸ªæ—¶é—´æ­¥

### vs Transformer

- âœ… **æ—¶é—´åºåˆ—ç‰¹åŒ–**: ä¸“é—¨ä¸ºæ—¶é—´åºåˆ—è®¾è®¡
- âœ… **å¤„ç†å¤šç§è¾“å…¥**: æ”¯æŒé™æ€ã€å·²çŸ¥ã€è§‚æµ‹ä¸‰ç§è¾“å…¥
- âœ… **æ›´é«˜æ•ˆ**: ç»“åˆLSTMå’ŒAttentionçš„ä¼˜åŠ¿
- âœ… **æ›´ç¨³å®š**: GRNå’Œæ®‹å·®è¿žæŽ¥æå‡è®­ç»ƒç¨³å®šæ€§

### vs XGBoost/LightGBM

- âœ… **æ•æ‰æ—¶åºä¾èµ–**: ç†è§£æ—¶é—´åºåˆ—çš„åŠ¨æ€å˜åŒ–
- âœ… **å¤šæ­¥é¢„æµ‹**: ç›´æŽ¥é¢„æµ‹æœªæ¥å¤šä¸ªæ—¶é—´ç‚¹
- âœ… **å¤„ç†é«˜ç»´æ•°æ®**: å¯ä»¥å¤„ç†å¤§é‡GPå› å­
- âœ… **ç«¯åˆ°ç«¯å­¦ä¹ **: è‡ªåŠ¨å­¦ä¹ ç‰¹å¾è¡¨ç¤º

## ðŸŽ“ å­¦ä¹ è·¯å¾„

### 1. åˆå­¦è€…

1. è¿è¡Œ `python tft_quick_start.py` äº†è§£åŸºæœ¬æµç¨‹
2. é˜…è¯» `TFT_README.md` ç†è§£æ•´ä½“æž¶æž„
3. å°è¯•ä¿®æ”¹ `tft_config.yaml` ä¸­çš„ç®€å•å‚æ•°
4. è¿è¡Œ `python tft_main.py` è¿›è¡Œå®Œæ•´è®­ç»ƒ

### 2. è¿›é˜¶ç”¨æˆ·

1. æ·±å…¥é˜…è¯» `TFT_ä½¿ç”¨è¯´æ˜Ž.md`
2. ç†è§£ `temporal_fusion_transformer.py` çš„å®žçŽ°ç»†èŠ‚
3. è‡ªå®šä¹‰æŸå¤±å‡½æ•°å’Œè¯„ä¼°æŒ‡æ ‡
4. è°ƒä¼˜è¶…å‚æ•°ä»¥èŽ·å¾—æœ€ä½³æ€§èƒ½

### 3. é«˜çº§ç”¨æˆ·

1. ä¿®æ”¹æ¨¡åž‹æž¶æž„ï¼ˆå¦‚å¢žåŠ æ–°çš„æ³¨æ„åŠ›å±‚ï¼‰
2. å®žçŽ°è‡ªå®šä¹‰çš„å˜é‡é€‰æ‹©ç­–ç•¥
3. é›†æˆåˆ°ç”Ÿäº§äº¤æ˜“ç³»ç»Ÿ
4. è¿›è¡Œå¤šæ¨¡åž‹é›†æˆ

## ðŸ”§ å¸¸ç”¨å‘½ä»¤

```bash
# å®‰è£…çŽ¯å¢ƒ
bash install_pytorch.sh
pip install -r requirements.txt

# å¿«é€Ÿæµ‹è¯•
python tft_quick_start.py

# å®Œæ•´è®­ç»ƒ
python tft_main.py

# æŸ¥çœ‹GPUçŠ¶æ€
nvidia-smi

# æ£€æŸ¥PyTorchå®‰è£…
python -c "import torch; print(torch.__version__); print(torch.cuda.is_available())"
```

## ðŸ“ é¡¹ç›®ç»“æž„

```
crypto-workstation/
â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ temporal_fusion_transformer.py  # â­ TFTæ ¸å¿ƒ
â”‚   â””â”€â”€ tft_data_processor.py          # â­ æ•°æ®å¤„ç†
â”‚
â”œâ”€â”€ tft_main.py                         # â­ è®­ç»ƒä¸»ç¨‹åº
â”œâ”€â”€ tft_quick_start.py                  # ðŸš€ å¿«é€Ÿå¼€å§‹
â”œâ”€â”€ tft_config.yaml                     # âš™ï¸ é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ TFT_README.md                       # ðŸ“– é¡¹ç›®æ¦‚è§ˆ
â”œâ”€â”€ TFT_ä½¿ç”¨è¯´æ˜Ž.md                     # ðŸ“– è¯¦ç»†æ–‡æ¡£
â”œâ”€â”€ TFT_é¡¹ç›®æ€»ç»“.md                     # ðŸ“– æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ install_pytorch.sh                  # ðŸ”§ å®‰è£…è„šæœ¬
â””â”€â”€ requirements.txt                    # ðŸ“¦ ä¾èµ–åˆ—è¡¨
```

## âœ… å®Œæˆæ¸…å•

- [x] TFTæ¨¡åž‹æ ¸å¿ƒå®žçŽ°
- [x] æ•°æ®é¢„å¤„ç†æ¨¡å—
- [x] è®­ç»ƒå™¨å®žçŽ°
- [x] å®Œæ•´çš„è®­ç»ƒä¸»ç¨‹åº
- [x] å¿«é€Ÿå¼€å§‹ç¤ºä¾‹
- [x] é…ç½®æ–‡ä»¶æ¨¡æ¿
- [x] è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
- [x] é¡¹ç›®æ¦‚è§ˆæ–‡æ¡£
- [x] å®‰è£…è„šæœ¬
- [x] ä¾èµ–æ›´æ–°
- [x] ä»£ç æµ‹è¯•ï¼ˆæ— è¯­æ³•é”™è¯¯ï¼‰

## ðŸŽŠ ä½ çŽ°åœ¨å¯ä»¥ï¼š

1. âœ… ä½¿ç”¨TFTè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹
2. âœ… å¤„ç†GPç”Ÿæˆçš„å› å­æ•°æ®
3. âœ… è®­ç»ƒã€è¯„ä¼°ã€å¯è§†åŒ–æ¨¡åž‹
4. âœ… èŽ·å¾—å¯è§£é‡Šçš„é¢„æµ‹ç»“æžœ
5. âœ… é›†æˆåˆ°çŽ°æœ‰çš„äº¤æ˜“ç³»ç»Ÿ

## ðŸ“ž ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³è¡ŒåŠ¨

1. **å¿«é€Ÿæµ‹è¯•**: `python tft_quick_start.py`
2. **å®Œæ•´è®­ç»ƒ**: `python tft_main.py`
3. **æŸ¥çœ‹ç»“æžœ**: æ£€æŸ¥ `tft_results_*` ç›®å½•

### ä¼˜åŒ–æ”¹è¿›

1. æ ¹æ®ä½ çš„æ•°æ®è°ƒæ•´çª—å£é•¿åº¦
2. å°è¯•ä¸åŒçš„æ¨¡åž‹å¤§å°
3. è¿›è¡Œè¶…å‚æ•°è°ƒä¼˜
4. ä¸Žå…¶ä»–æ¨¡åž‹ï¼ˆXGBoostç­‰ï¼‰å¯¹æ¯”

### ç”Ÿäº§éƒ¨ç½²

1. å°†æœ€ä½³æ¨¡åž‹é›†æˆåˆ°äº¤æ˜“ç­–ç•¥
2. å®žçŽ°å®žæ—¶é¢„æµ‹pipeline
3. è®¾ç½®æ¨¡åž‹ç›‘æŽ§å’Œé‡è®­ç»ƒ
4. è¿›è¡Œå›žæµ‹éªŒè¯

## ðŸŒŸ ç‰¹åˆ«è¯´æ˜Ž

è¿™ä¸ªå®žçŽ°ï¼š

- âœ… **ç”Ÿäº§çº§ä»£ç **: å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… **é«˜æ€§èƒ½**: ä¼˜åŒ–çš„æ•°æ®åŠ è½½å’Œè®­ç»ƒæµç¨‹
- âœ… **æ˜“æ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºŽä¿®æ”¹å’Œæ‰©å±•
- âœ… **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„æ³¨é‡Šå’Œä½¿ç”¨æ–‡æ¡£
- âœ… **å¼€ç®±å³ç”¨**: æ— éœ€é¢å¤–é…ç½®å³å¯è¿è¡Œ

## ðŸŽ é¢å¤–ç¦åˆ©

### ä»£ç è´¨é‡

- éµå¾ª PEP 8 è§„èŒƒ
- å®Œæ•´çš„ç±»åž‹æ³¨è§£
- è¯¦ç»†çš„æ–‡æ¡£å­—ç¬¦ä¸²
- æ— linteré”™è¯¯

### å¯ç»´æŠ¤æ€§

- æ¨¡å—åŒ–è®¾è®¡
- æ¸…æ™°çš„ä»£ç ç»“æž„
- ä¸°å¯Œçš„æ³¨é‡Š
- æ˜“äºŽç†è§£å’Œä¿®æ”¹

### å¯æ‰©å±•æ€§

- æ”¯æŒè‡ªå®šä¹‰æŸå¤±å‡½æ•°
- æ”¯æŒè‡ªå®šä¹‰è¯„ä¼°æŒ‡æ ‡
- æ”¯æŒè‡ªå®šä¹‰æ•°æ®é¢„å¤„ç†
- æ”¯æŒæ¨¡åž‹æž¶æž„ä¿®æ”¹

## ðŸ† æ€»ç»“

ä½ çŽ°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ªï¼š

- â­ **å®Œæ•´çš„** TFT å®žçŽ°
- â­ **ä¸“ä¸šçš„** æ—¶é—´åºåˆ—é¢„æµ‹å·¥å…·
- â­ **æ˜“ç”¨çš„** è®­ç»ƒå’Œè¯„ä¼°æµç¨‹
- â­ **è¯¦ç»†çš„** æ–‡æ¡£å’Œç¤ºä¾‹

**å¼€å§‹ä½¿ç”¨å§ï¼ðŸš€**

```bash
python tft_quick_start.py
```

---

**é¡¹ç›®å®Œæˆæ—¶é—´**: 2025-11-05  
**ä»£ç æ€»è¡Œæ•°**: 2000+ è¡Œ  
**æ–‡æ¡£æ€»å­—æ•°**: 10000+ å­—  
**é¢„è®¡é˜…è¯»æ—¶é—´**: 30åˆ†é’Ÿ  
**é¢„è®¡ä¸Šæ‰‹æ—¶é—´**: 10åˆ†é’Ÿ  

ç¥ä½ è®­ç»ƒæ„‰å¿«ï¼å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·å‚è€ƒè¯¦ç»†æ–‡æ¡£ã€‚ðŸŽ‰

